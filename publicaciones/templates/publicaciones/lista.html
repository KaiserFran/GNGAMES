{% extends "base.html" %}
{% block title %}Inicio{% endblock %}




{% block content %}
<!DOCTYPE html>
<html>
<head>
    <title>Publicaciones</title>
</head>
<body>
    <h1>Lista de publicaciones</h1>
    
{% if user.is_authenticated %}
  <p><a href="{% url 'crear_publicacion' %}">âž• Crear nueva publicaciÃ³n</a></p>
{% else %}
  <p>Debes <a href="{% url 'login' %}">iniciar sesiÃ³n</a> para publicar.</p>
{% endif %}

    <ul>
        {% for publicacion in publicaciones %}
            <li>
                <strong>{{ publicacion.titulo }}</strong> â€” {{ publicacion.usuario.username }}<br>
                {% if publicacion.imagen %}
                    <img src="{{ publicacion.imagen.url }}" alt="{{ publicacion.titulo }}" width="200">
                {% endif %}
                <p>{{ publicacion.descripcion|linebreaks }}</p>
                <small>{{ publicacion.fecha_creacion }}</small>

                <!-- BOTÃ“N BORRAR (solo dueÃ±o) -->
                {% if publicacion.usuario == user %}
                    <a href="{% url 'borrar_publicacion' publicacion.pk %}" style="color:red;">ðŸ—‘ Borrar</a>
                {% endif %}

                <!-- BLOQUE DE COMENTARIOS -->
                <h4>Comentarios:</h4>
                <ul>
                    {% for comentario in publicacion.comentarios.all %}
                        <li><strong>{{ comentario.usuario.username }}:</strong> {{ comentario.texto }} <small>({{ comentario.fecha_creacion }})</small></li>
                    {% empty %}
                        <li>No hay comentarios aÃºn.</li>
                    {% endfor %}
                </ul>
                <a href="{% url 'agregar_comentario' publicacion.pk %}">Agregar comentario</a>
                <!-- FIN BLOQUE DE COMENTARIOS -->
            </li>
        {% empty %}
            <li>No hay publicaciones aÃºn.</li>
        {% endfor %}
    </ul>
</body>
{% endblock %}
</html>
